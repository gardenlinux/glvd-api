= Garden Linux Vulnerability Database REST API
Garden Linux Authors
:doctype: book
:icons: font
:source-highlighter: highlightjs
:toc:

This document describes the HTTP API endpoints of the Garden Linux Vulnerability Database (GLVD).

Find out more about GLVD at https://security.gardenlinux.org and https://github.com/gardenlinux/glvd.

This document provides real HTTP requests and responses captured from API tests.
The data shown is based on unit tests and may differ from production data, but the structure of requests and responses remains consistent.

== Triage Data

Triage is the process where the Garden Linux security team evaluates security vulnerabilities (CVEs) to determine their impact on Garden Linux releases.
Getting Triage data is one of the main features of the GLVD API.

[TIP]
.Understanding the 'resolved' Field
====
In GLVD, triage data gives extra context about a CVE for a specific Garden Linux release. For example, it can mark a CVE as a false positive or note that a fix is available upstream and will be included in a future release.

The `resolved` (or `triageMarkedAsResolved`) field acts as an override. If set to `true`, it tells GLVD to treat the vulnerability as resolved, regardless of other data. If `false`, it has no effect.

The main field to check is `vulnerable`. Its value depends on several factors, including data from the Debian Security Tracker and the `resolved` field.
====

=== List Triages for a Garden Linux Release

Retrieve triaged security vulnerabilities for a Garden Linux release.

include::{snippets}/triagesGardenlinux/curl-request.adoc[]

Example response:

include::{snippets}/triagesGardenlinux/http-response.adoc[]

=== Get Triages for a CVE

Retrieve triage information for a specific CVE by its ID.

include::{snippets}/triagesCve/curl-request.adoc[]

Example response:

include::{snippets}/triagesCve/http-response.adoc[]

=== Get Triages for a Debian Source Package

Retrieve triage information for all CVEs related to a Debian source package.

include::{snippets}/triagesPackage/curl-request.adoc[]

Example response:

include::{snippets}/triagesPackage/http-response.adoc[]

=== List All Triages

Retrieve a list of triages regardless of the Garden Linux release.

include::{snippets}/triagesList/curl-request.adoc[]

Example response:

include::{snippets}/triagesList/http-response.adoc[]

== CVE Data

=== List CVEs by Distribution

Retrieve all CVEs for a given distribution and version:

include::{snippets}/getCveForDistro/curl-request.adoc[]

TIP: The `sortBy` and `sortOrder` query parameters are optional. If omitted, default sorting is applied.

Example response:

include::{snippets}/getCveForDistro/http-response.adoc[]

=== List CVEs by Image

Retrieve all CVEs for a given Garden Linux image and version.
This applies a filter for the packages in the specified image.

Supported images are currently:

- `ali-gardener_prod`
- `aws-gardener_prod`
- `azure-gardener_prod`
- `gcp-gardener_prod`
- `openstack-gardener_prod`

include::{snippets}/getCveForImage/curl-request.adoc[]

Example response:

include::{snippets}/getCveForImage/http-response.adoc[]

=== List CVEs for Packages by Distribution

Retrieve all CVEs for a list of packages in a specified distribution.
Package names are comma-separated (URL-encoding may be required).

include::{snippets}/getCveForPackages/curl-request.adoc[]

Example response:

include::{snippets}/getCveForPackages/http-response.adoc[]

=== List CVEs for Packages by Distribution (PUT)

Retrieve all CVEs for a list of packages in a specified distribution.
Package names are provided in the request body as JSON.

include::{snippets}/getCveForPackagesPut/curl-request.adoc[]

Example response:

include::{snippets}/getCveForPackagesPut/http-response.adoc[]

=== Get Vulnerabilities for a Package

Retrieve vulnerabilities for a specific package.

include::{snippets}/getPackageWithVulnerabilities/curl-request.adoc[]

Example response:

include::{snippets}/getPackageWithVulnerabilities/http-response.adoc[]

=== Get Vulnerabilities for a Package by Version

Retrieve vulnerabilities for a specific package and version.

include::{snippets}/getPackageWithVulnerabilitiesByVersion/curl-request.adoc[]

Example response:

include::{snippets}/getPackageWithVulnerabilitiesByVersion/http-response.adoc[]

=== List Packages Affected by a Vulnerability

Retrieve a list of packages affected by a specific vulnerability.

include::{snippets}/getPackagesByVulnerability/curl-request.adoc[]

Example response:

include::{snippets}/getPackagesByVulnerability/http-response.adoc[]

=== Get CVE Details with Triage Data

Retrieve information about a CVE by its ID.
If triage data is available for this CVE, it is included in the response.

include::{snippets}/getCveDetailsWithContexts/curl-request.adoc[]

Example response:

include::{snippets}/getCveDetailsWithContexts/http-response.adoc[]

==== Linux Kernel CVEs

For CVEs affecting the Linux kernel, the response structure differs.
Data is sourced from upstream kernel developers for LTS kernel versions in Garden Linux.

NOTE: For the Linux kernel, Garden Linux always builds LTS kernels directly from the upstream source, applying both Debian patches and custom patches as needed. Therefore, CVEs reported by Debian for the kernel do not directly apply. Instead, kernel vulnerability information is sourced from upstream kernel developers, and Debian kernel CVEs are ignored in Garden Linux.

include::{snippets}/getCveDetailsWithContextsKernel/curl-request.adoc[]

Example response:

include::{snippets}/getCveDetailsWithContextsKernel/http-response.adoc[]

=== Get CVE Details for Non-Debian CVEs

For CVEs not present in the Debian Security Tracker, only basic information is provided.

include::{snippets}/getCveDetailsNonDebian/curl-request.adoc[]

Example response:

include::{snippets}/getCveDetailsNonDebian/http-response.adoc[]

== Garden Linux Release Data

=== List All Garden Linux Releases

Retrieve all known Garden Linux releases in GLVD.

include::{snippets}/getAllGardenLinuxVersions/curl-request.adoc[]

Example response:

include::{snippets}/getAllGardenLinuxVersions/http-response.adoc[]

=== List Packages in a Distribution

Retrieve a list of packages for a given distribution.

include::{snippets}/getPackages/curl-request.adoc[]

Example response:

include::{snippets}/getPackages/http-response.adoc[]

=== Get Release Notes

Retrieve information about fixed security vulnerabilities in a minor release of Garden Linux.

include::{snippets}/releaseNotes/curl-request.adoc[]

Example response:

include::{snippets}/releaseNotes/http-response.adoc[]
